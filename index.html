<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criptograf√≠a Post-Cu√°ntica - Presentaci√≥n Interactiva</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 60px 20px;
            color: white;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 20px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
            position: relative;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.3em;
            opacity: 0.9;
        }

        .header-names {
            position: absolute;
            bottom: 20px;
            left: 20px;
            text-align: left;
            font-size: 1.15em;
            line-height: 1.4;
            opacity: 0.9;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        p {
            line-height: 1.8;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .interactive-demo {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid #667eea;
        }

        .demo-title {
            color: #667eea;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        input, textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: monospace;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .output {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            font-family: monospace;
            word-break: break-all;
        }

        .key-display {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.9em;
        }

        .warning {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        #readiness-checklist label {
            display: grid;
            grid-template-columns: 28px 1fr;
            align-items: start;
            column-gap: 12px;
            margin: 8px 0;
            font-size: 1.05em;
        }

        #readiness-checklist input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-top: 3px;
            justify-self: center;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            .container {
                padding: 14px;
            }
            header {
                padding: 40px 16px 24px;
            }
            h1 {
                font-size: 2em;
            }
            h2 {
                font-size: 1.6em;
            }
            h3 {
                font-size: 1.2em;
            }
            .header-names {
                position: static;
                margin-top: 14px;
                text-align: center;
                font-size: 1em;
            }
            .section {
                padding: 24px 18px;
            }
            .interactive-demo {
                padding: 20px;
            }
            button {
                width: 100%;
                margin: 8px 0;
            }
            input,
            textarea {
                font-size: 16px;
            }
            .comparison-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            .whiteboard-header {
                flex-wrap: wrap;
            }
        }

        .quantum-visual {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .qubit {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px;
            animation: pulse 2s infinite;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        .comparison-table tr:hover {
            background: #f5f7fa;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .conclusion {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            text-align: center;
            margin-top: 40px;
        }

        .conclusion h2 {
            color: white;
            border-bottom: 3px solid white;
        }

        ul {
            margin: 15px 0 15px 30px;
            line-height: 2;
        }

        li {
            margin: 10px 0;
        }

        .highlight {
            background: linear-gradient(120deg, #ffd89b 0%, #19547b 100%);
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .code-block {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
.kyber-steps {
  display: grid;
  gap: 12px;
  margin-top: 14px;
}
.kyber-step {
  background: #f8f9fa;
  border-left: 4px solid #c3cfe2;
  padding: 12px 14px;
  border-radius: 8px;
  transition: border-color 0.3s, background 0.3s;
}
.kyber-step.active {
  border-color: #667eea;
  background: #eef1ff;
}
.kyber-step.done {
  border-color: #28a745;
  background: #e9f7ef;
}
.kyber-step-title {
  font-weight: bold;
  color: #3b4cca;
  margin-bottom: 6px;
}
.kyber-step-detail {
  font-family: monospace;
  font-size: 0.95em;
  color: #2b2f3a;
}
.kyber-step-visual {
  margin-top: 10px;
}
.kyber-visual {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.kyber-node {
  background: #ffffff;
  border: 2px solid #c3cfe2;
  border-radius: 10px;
  padding: 8px 10px;
  min-width: 120px;
  text-align: center;
  font-family: monospace;
  font-size: 0.9em;
}
.kyber-node-title {
  font-weight: bold;
  color: #3b4cca;
  margin-bottom: 6px;
}
.kyber-chip {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 6px;
  background: #eef1ff;
  border: 1px solid #cbd6ff;
  margin: 2px;
}
.kyber-arrow {
  font-family: monospace;
  font-weight: bold;
  color: #667eea;
}
.kyber-interactive-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 18px;
  margin-top: 16px;
}
.kyber-panel {
  background: #0f1325;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 12px;
  padding: 16px;
  color: #e7ecff;
}
.kyber-panel-grid {
  display: grid;
  grid-template-columns: 0.9fr 1.1fr;
  gap: 16px;
}
.kyber-legend-box {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 10px;
  padding: 12px;
  font-size: 0.9em;
  color: #dbe3ff;
}
.kyber-legend-box h5 {
  margin-bottom: 8px;
  color: #b9c7ff;
}
.kyber-legend-box ul {
  margin: 0;
  padding-left: 18px;
  line-height: 1.6;
  font-family: monospace;
}
.kyber-legend-box li {
  margin: 6px 0;
}
.kyber-panel h4 {
  color: #b9c7ff;
  margin-bottom: 8px;
}
.kyber-math {
  font-family: monospace;
  font-size: 0.95em;
  color: #e2e7ff;
}
.kyber-math-line {
  margin: 6px 0;
}
.kyber-keybox {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 12px;
}
.kyber-pill {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 999px;
  padding: 4px 10px;
  font-family: monospace;
  font-size: 0.85em;
  color: #e7ecff;
}
.kyber-pill strong {
  color: #b9c7ff;
  margin-right: 4px;
}
.kyber-controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 12px;
}
.kyber-controls button {
  padding: 10px 16px;
  font-size: 0.95em;
}
.kyber-step-list {
  margin-top: 12px;
  padding-left: 18px;
  line-height: 1.6;
  color: #dfe6ff;
  font-family: monospace;
}
.kyber-formula {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  padding: 10px 12px;
  font-family: monospace;
  color: #f4f6ff;
  margin-top: 10px;
}
.shor-steps {
  display: grid;
  gap: 12px;
  margin-top: 14px;
}
.shor-step {
  background: #f8f9fa;
  border-left: 4px solid #c3cfe2;
  padding: 12px 14px;
  border-radius: 8px;
  transition: border-color 0.3s, background 0.3s;
}
.shor-step.active {
  border-color: #667eea;
  background: #eef1ff;
}
.shor-step.done {
  border-color: #28a745;
  background: #e9f7ef;
}
.shor-step-title {
  font-weight: bold;
  color: #3b4cca;
  margin-bottom: 6px;
}
.shor-step-detail {
  font-family: monospace;
  font-size: 0.95em;
  color: #2b2f3a;
}
.whiteboard-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 18, 35, 0.96);
  z-index: 9999;
  display: none;
  flex-direction: column;
}

.whiteboard-header {
  padding: 12px 16px;
  display: flex;
  gap: 10px;
  align-items: center;
  background: rgba(255,255,255,0.05);
  color: white;
}

.whiteboard-header button {
  padding: 8px 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  font-weight: bold;
}
.whiteboard-header input[type="color"] {
  width: 44px;
  height: 32px;
  border: none;
  border-radius: 6px;
  padding: 0;
  cursor: pointer;
  background: transparent;
}
.whiteboard-header input[type="range"] {
  width: 120px;
}
.whiteboard-header .tool-toggle {
  background: #667eea;
  color: white;
}
.whiteboard-header .tool-toggle.active {
  background: #ffc107;
  color: #111;
}
.whiteboard-header .tool-secondary {
  background: #17a2b8;
  color: white;
}

.whiteboard-header .close {
  background: #dc3545;
  color: white;
}

.whiteboard-header .clear {
  background: #ffc107;
}

.whiteboard-canvas {
  flex: 1;
  background: #111;
  cursor: crosshair;
  touch-action: none;
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-names">
                Victor Llivina<br>
                Rafael Torres<br>
                Adalid Claure
            </div>
            <h1>üîê Criptograf√≠a Post-Cu√°ntica</h1>
            <p class="subtitle">El Futuro de la Seguridad en la Era Cu√°ntica</p>
        </header>

        <!-- Secci√≥n 1: Introducci√≥n -->
        <section class="section">
            <h2>Introducci√≥n: La Amenaza Cu√°ntica</h2>
            
            <p>La <span class="highlight">criptograf√≠a post-cu√°ntica</span> representa el pr√≥ximo paradigma en seguridad inform√°tica. Mientras que la criptograf√≠a actual protege nuestros datos mediante problemas matem√°ticos dif√≠ciles de resolver para computadoras cl√°sicas, las computadoras cu√°nticas amenazan con romper estos sistemas de seguridad.</p>

            <div class="info-box">
                <h3>üéØ ¬øPor qu√© es importante?</h3>
                <ul>
                    <li><strong>Harvest Now, Decrypt Later:</strong> Los atacantes est√°n almacenando datos cifrados hoy para descifrarlos cuando tengan computadoras cu√°nticas</li>
                    <li><strong>Infraestructura Cr√≠tica:</strong> Sistemas bancarios, gubernamentales y de comunicaciones dependen de criptograf√≠a vulnerable</li>
                    <li><strong>Transici√≥n Larga:</strong> Migrar sistemas criptogr√°ficos a nivel mundial tomar√° d√©cadas</li>
                </ul>
            </div>

            <div class="quantum-visual">
                <div class="qubit">|0‚ü©</div>
                <div class="qubit">|1‚ü©</div>
                <div class="qubit">|+‚ü©</div>
                <div class="qubit">|-‚ü©</div>
            </div>
            <p style="text-align: center; font-style: italic; color: #667eea;">Estados cu√°nticos: superposici√≥n y entrelazamiento</p>
        </section>

        <!-- Secci√≥n 2: Computaci√≥n Cu√°ntica 101 -->
        <section class="section">
            <h2>‚öõÔ∏è Computaci√≥n Cu√°ntica: Conceptos B√°sicos</h2>
            
            <h3>¬øQu√© hace especial a una computadora cu√°ntica?</h3>
            
            <div class="grid-2">
                <div>
                    <h4 style="color: #667eea;">Computaci√≥n Cl√°sica</h4>
                    <ul>
                        <li>Bits: 0 o 1</li>
                        <li>Procesamiento secuencial</li>
                        <li>Determinista</li>
                        <li>Estados definidos</li>
                    </ul>
                </div>
                <div>
                    <h4 style="color: #764ba2;">Computaci√≥n Cu√°ntica</h4>
                    <ul>
                        <li>Qubits: 0, 1, o ambos (superposici√≥n)</li>
                        <li>Procesamiento paralelo masivo</li>
                        <li>Probabil√≠stica</li>
                        <li>Entrelazamiento cu√°ntico</li>
                    </ul>
                </div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title"> Demostraci√≥n: Superposici√≥n Cu√°ntica vs Bits Cl√°sicos</div>
                
                <p><strong>Simula el poder de un qubit en superposici√≥n:</strong></p>
                
                <div class="grid-2">
                    <div>
                        <h4>Bit Cl√°sico</h4>
                        <button onclick="classicalCompute()">Procesar 1 Bit</button>
                        <div id="classical-result" class="output" style="min-height: 100px;"></div>
                    </div>
                    <div>
                        <h4>Qubit en Superposici√≥n</h4>
                        <button onclick="quantumCompute()">Procesar 1 Qubit</button>
                        <div id="quantum-result" class="output" style="min-height: 100px;"></div>
                    </div>
                </div>
                
                <div class="info-box" style="margin-top: 20px;">
                    <strong>Escalabilidad:</strong> Con n qubits, una computadora cu√°ntica puede procesar 2^n estados simult√°neamente.
                    <br>Ejemplo: 300 qubits = m√°s estados que √°tomos en el universo observable.
                </div>
            </div>

            <h3>El Algoritmo de Shor: Rompiendo RSA</h3>
            <p>El algoritmo de Shor, desarrollado en 1994, puede factorizar n√∫meros grandes en tiempo polin√≥mico usando una computadora cu√°ntica. Esto rompe directamente la seguridad de RSA, que se basa en que factorizar n√∫meros grandes es computacionalmente imposible.</p>
            
            <div class="warning">
                <strong>‚ö†Ô∏è Impacto:</strong> Una computadora cu√°ntica con ~4000 qubits l√≥gicos podr√≠a romper RSA-2048 en cuesti√≥n de horas, exponiendo pr√°cticamente todos los sistemas criptogr√°ficos actuales.
            </div>
        </section>

        

        <!-- Secci√≥n 3: Criptograf√≠a Actual y Vulnerabilidades -->
        <section class="section">
            <h2>üîì Criptograf√≠a Cl√°sica</h2>
            
            <h3>Algoritmo RSA</h3>
            
            <div class="interactive-demo">
                <div class="demo-title">üîê Demostraci√≥n Interactiva: RSA Simplificado</div>
                
                <p>Vamos a encriptar un mensaje usando RSA con n√∫meros peque√±os (en la realidad se usan n√∫meros de 2048+ bits):</p>
                
                <div>
                    <label><strong>Tu mensaje:</strong></label>
                    <input type="text" id="rsa-message" placeholder="Escribe un mensaje corto" maxlength="10">
                    
                    <button onclick="generateRSAKeys()">1. Generar Claves RSA</button>
                    
                    <div id="rsa-keys" class="key-display" style="display:none;">
                        <strong>Claves Generadas:</strong><br>
                        Primos: p = <span id="p-value"></span>, q = <span id="q-value"></span><br>
                        n (p √ó q) = <span id="n-value"></span><br>
                        Clave P√∫blica (e, n): (<span id="e-value"></span>, <span id="n-public"></span>)<br>
                        Clave Privada (d, n): (<span id="d-value"></span>, <span id="n-private"></span>)
                    </div>
                    
                    <button onclick="encryptRSA()" id="encrypt-btn" style="display:none;">2. Encriptar Mensaje</button>
                    
                    <div id="rsa-encrypted" class="output" style="display:none;">
                        <strong>Mensaje Encriptado:</strong><br>
                        <span id="encrypted-text"></span>
                    </div>
                    
                    <button onclick="decryptRSA()" id="decrypt-btn" style="display:none;">3. Desencriptar Mensaje</button>
                    
                    <div id="rsa-decrypted" class="success" style="display:none;">
                        <strong>Mensaje Desencriptado:</strong><br>
                        <span id="decrypted-text"></span>
                    </div>
                </div>
                
                <div class="warning" style="margin-top: 20px;">
                    <strong>Vulnerabilidad Cu√°ntica:</strong> El algoritmo de Shor puede factorizar n en p y q eficientemente, recuperando la clave privada d. ¬°La seguridad de RSA colapsar√≠a!
                </div>
                
                <button onclick="simulateQuantumBreak()">‚öõÔ∏è Simular Ataque Cu√°ntico (Algoritmo de Shor)</button>
                
                <div id="quantum-attack" style="display:none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="attack-progress">0%</div>
                    </div>
                    <div class="warning" id="attack-result"></div>
                </div>
            </div>

            <h3>Otros Sistemas Vulnerables</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Sistema Criptogr√°fico</th>
                        <th>Base Matem√°tica</th>
                        <th>Algoritmo Cu√°ntico que lo Rompe</th>
                        <th>Estado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>RSA</td>
                        <td>Factorizaci√≥n de enteros</td>
                        <td>Algoritmo de Shor</td>
                        <td>‚ùå Vulnerable</td>
                    </tr>
                    <tr>
                        <td>Diffie-Hellman</td>
                        <td>Logaritmo discreto</td>
                        <td>Algoritmo de Shor</td>
                        <td>‚ùå Vulnerable</td>
                    </tr>
                    <tr>
                        <td>ECC (Curvas El√≠pticas)</td>
                        <td>Logaritmo discreto en curvas</td>
                        <td>Algoritmo de Shor modificado</td>
                        <td>‚ùå Vulnerable</td>
                    </tr>
                    <tr>
                        <td>AES-256</td>
                        <td>Cifrado sim√©trico</td>
                        <td>Algoritmo de Grover</td>
                        <td>‚ö†Ô∏è Debilitado (efectivamente AES-128)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Secci√≥n 4: Criptograf√≠a Post-Cu√°ntica -->
        <section class="section">
            <h2>üõ°Ô∏è Criptograf√≠a Post-Cu√°ntica: La Soluci√≥n</h2>
            
            <p>La criptograf√≠a post-cu√°ntica se basa en problemas matem√°ticos que permanecen dif√≠ciles incluso para computadoras cu√°nticas.</p>

            <h3>Familias de Algoritmos Post-Cu√°nticos</h3>
            
            <div class="grid-2">
                <div class="info-box">
                    <h4>1. Criptograf√≠a Basada en Ret√≠culas (Lattices)</h4>
                    <p><strong>Ejemplos:</strong> CRYSTALS-Kyber, CRYSTALS-Dilithium</p>
                    <p><strong>Problema:</strong> Encontrar el vector m√°s corto en un ret√≠culo de alta dimensi√≥n</p>
                    <p><strong>Estado:</strong> ‚úÖ Estandarizado por NIST en 2024</p>
                </div>
                
                <div class="info-box">
                    <h4>2. Criptograf√≠a Basada en Hash</h4>
                    <p><strong>Ejemplos:</strong> SPHINCS+</p>
                    <p><strong>Problema:</strong> Basado en resistencia de funciones hash criptogr√°ficas</p>
                    <p><strong>Estado:</strong> ‚úÖ Estandarizado por NIST</p>
                </div>
                
                <div class="info-box">
                    <h4>3. Criptograf√≠a Basada en C√≥digos</h4>
                    <p><strong>Ejemplos:</strong> Classic McEliece</p>
                    <p><strong>Problema:</strong> Decodificaci√≥n de c√≥digos lineales aleatorios</p>
                    <p><strong>Estado:</strong> üîÑ En evaluaci√≥n</p>
                </div>
                
                <div class="info-box">
                    <h4>4. Criptograf√≠a Multivariada</h4>
                    <p><strong>Ejemplos:</strong> Rainbow (descartado)</p>
                    <p><strong>Problema:</strong> Resolver sistemas de ecuaciones polinomiales multivariadas</p>
                    <p><strong>Estado:</strong> ‚ö†Ô∏è Algunos algoritmos rotos</p>
                </div>
            </div>

            <h3>CRYSTALS-Kyber - Explicaci√≥n simple</h3>
            <p><strong>¬øQu√© es?</strong> Kyber es un algoritmo post-cu√°ntico de <strong>encapsulaci√≥n de claves (KEM)</strong>. Su objetivo es que dos partes acuerden un secreto compartido que luego se usa para cifrar mensajes con un cifrado sim√©trico (por ejemplo, AES).</p>
            <p><strong>Problema que resuelve:</strong> Las computadoras cu√°nticas podr√°n romper RSA y otros esquemas basados en factorizaci√≥n o logaritmos discretos. Kyber se apoya en problemas de <strong>ret√≠culas (lattices)</strong> que siguen siendo dif√≠ciles incluso con computaci√≥n cu√°ntica.</p>

            <h4 style="color: #764ba2;">¬øC√≥mo funciona? (versi√≥n simple)</h4>
            <ul>
                <li><strong>Ret√≠culas:</strong> imagina una red de puntos en muchas dimensiones. Encontrar el punto correcto o el m√°s cercano en esa red es extremadamente dif√≠cil.</li>
                <li><strong>Intercambio de claves (lo m√°s importante):</strong> Kyber no cifra el mensaje directamente; encapsula un secreto compartido.</li>
            </ul>

            <div class="info-box">
                <h4>Intercambio de claves, paso a paso</h4>
                <ul>
                    <li><strong>Paso 1 - KeyGen (Bob):</strong> Bob genera una clave p√∫blica y una privada. La p√∫blica incluye una estructura con <em>ruido controlado</em>.</li>
                    <li><strong>Paso 2 - Encapsulate (Alice):</strong> Alice usa la clave p√∫blica de Bob, a√±ade su propio ruido y env√≠a un <em>ciphertext</em> que contiene el secreto encapsulado.</li>
                    <li><strong>Paso 3 - Decapsulate (Bob):</strong> Bob usa su clave privada para eliminar el ruido y recuperar el mismo secreto compartido.</li>
                </ul>
                <p><strong>La clave del sistema:</strong> el ruido es lo bastante grande para confundir atacantes, pero lo bastante peque√±o para que Bob pueda recuperarlo.</p>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">üî¨ Kyber con n√∫meros peque√±os (paso a paso)</div>

                <p>Este demo muestra la matem√°tica b√°sica con n√∫meros peque√±os. Es solo educativo.</p>

                <div class="grid-2">
                    <div>
                        <label><strong>Bit de mensaje (m):</strong></label>
                        <select id="kyber-bit" onchange="kyberReset()">
                            <option value="0">0</option>
                            <option value="1" selected>1</option>
                        </select>
                    </div>
                    <div style="display:flex; align-items:end; gap:10px;">
                        <button type="button" onclick="openBoard()">üñäÔ∏è Abrir pizarra</button>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="kyber-progress">0%</div>
                </div>

                <div class="kyber-interactive-grid">
                    <div class="kyber-panel">
                        <div class="kyber-panel-grid">
                            <div class="kyber-legend-box">
                                <h5>Variables clave</h5>
                                <ul>
                                    <li>A: matriz publica</li>
                                    <li>s: secreto de Bob</li>
                                    <li>e, e1, e2: ruido pequeno</li>
                                    <li>r: aleatorio de Alice</li>
                                    <li>b: clave publica</li>
                                    <li>u, v: cifrado</li>
                                    <li>m: bit (0/1)</li>
                                    <li>m': m escalado</li>
                                </ul>
                            </div>
                            <div>
                                <h4 id="kyber-step-title">Paso 1</h4>
                                <p id="kyber-step-desc"></p>
                                <div id="kyber-step-formula" class="kyber-formula"></div>
                                <div id="kyber-step-details" class="kyber-math"></div>
                                <div id="kyber-step-keybox" class="kyber-keybox"></div>

                                <div id="kyber-step-list" class="kyber-step-list"></div>

                                <div class="kyber-controls">
                                    <button type="button" onclick="kyberPrev()">‚Üê Anterior</button>
                                    <button type="button" onclick="kyberReset()">Reiniciar</button>
                                    <button type="button" onclick="kyberNext()">Siguiente ‚Üí</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="success" style="margin-top: 16px;">
                    <strong>‚úÖ Resistencia Cu√°ntica:</strong> No existe un algoritmo cu√°ntico conocido que resuelva eficientemente los problemas de ret√≠culas usados por Kyber.
                </div>
            </div>

            
        </section>

        <!-- Secci√≥n 5: Ataque Interactivo -->
        <section class="section">
            <h2>üí• Visualizaci√≥n: Ataque Cu√°ntico en Acci√≥n</h2>
            
            <div class="interactive-demo">
                <div class="demo-title">‚öîÔ∏è Simulador de Ataque: Cl√°sica vs Post-Cu√°ntica</div>
                
                <p>Compara cu√°nto tiempo le tomar√≠a a diferentes tipos de computadoras romper la encriptaci√≥n:</p>
                
                <div class="grid-2">
                    <div>
                        <h4>Objetivo: RSA-2048</h4>
                        <button onclick="attackClassical('rsa')">Atacar con Computadora Cl√°sica</button>
                        <button onclick="attackQuantum('rsa')">Atacar con Computadora Cu√°ntica</button>
                        <div id="rsa-attack-result" class="output"></div>
                    </div>
                    
                    <div>
                        <h4>Objetivo: CRYSTALS-Kyber-768</h4>
                        <button onclick="attackClassical('kyber')">Atacar con Computadora Cl√°sica</button>
                        <button onclick="attackQuantum('kyber')">Atacar con Computadora Cu√°ntica</button>
                        <div id="kyber-attack-result" class="output"></div>
                    </div>
                </div>
                
                <div class="info-box" style="margin-top: 20px;">
                    <strong>üìä Interpretaci√≥n:</strong>
                    <ul>
                        <li>RSA es seguro contra computadoras cl√°sicas (tomar√≠a miles de a√±os) pero vulnerable a cu√°nticas (horas/d√≠as)</li>
                        <li>Kyber es seguro contra AMBOS tipos de computadoras (siglos incluso con cu√°nticas)</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Secci√≥n 6: Implementaci√≥n Pr√°ctica -->
        <section class="section">
            <h2>üöÄ Implementaci√≥n y Migraci√≥n</h2>
            
            <h3>Proceso de NIST</h3>
            <p>En julio de 2024, el NIST (National Institute of Standards and Technology) finaliz√≥ la estandarizaci√≥n de los primeros algoritmos post-cu√°nticos:</p>
            
            <div class="success">
                <strong>Est√°ndares FIPS Publicados (2024):</strong>
                <ul>
                    <li><strong>FIPS 203:</strong> CRYSTALS-Kyber (ahora ML-KEM) - Encapsulaci√≥n de claves</li>
                    <li><strong>FIPS 204:</strong> CRYSTALS-Dilithium (ahora ML-DSA) - Firmas digitales</li>
                    <li><strong>FIPS 205:</strong> SPHINCS+ (ahora SLH-DSA) - Firmas digitales basadas en hash</li>
                </ul>
            </div>

            <h3>Estrategias de Migraci√≥n</h3>
            
            <div class="grid-2">
                <div class="info-box">
                    <h4>üîÑ Criptograf√≠a H√≠brida</h4>
                    <p>Combinar algoritmos cl√°sicos con post-cu√°nticos durante la transici√≥n:</p>
                    <ul>
                        <li>RSA + Kyber</li>
                        <li>ECDSA + Dilithium</li>
                    </ul>
                    <p><strong>Ventaja:</strong> Protecci√≥n inmediata sin romper compatibilidad</p>
                </div>
                
                <div class="info-box">
                    <h4>üìÖ L√≠nea de Tiempo</h4>
                    <ul>
                        <li><strong>2024-2025:</strong> Implementaci√≥n en sistemas cr√≠ticos</li>
                        <li><strong>2025-2030:</strong> Adopci√≥n generalizada</li>
                        <li><strong>2030-2035:</strong> Reemplazo completo</li>
                    </ul>
                </div>
            </div>

            <div class="interactive-demo">
                <div class="demo-title">üéØ Checklist: ¬øEst√° tu organizaci√≥n lista?</div>
                
                <div id="readiness-checklist">
                    <label><input type="checkbox" onchange="updateReadiness()"> Inventario de sistemas criptogr√°ficos completado</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Priorizaci√≥n de activos cr√≠ticos realizada</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Evaluaci√≥n de compatibilidad con PQC iniciada</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Plan de migraci√≥n documentado</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Implementaci√≥n h√≠brida en curso</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Capacitaci√≥n de equipo completada</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Pruebas de rendimiento realizadas</label>
                    <label><input type="checkbox" onchange="updateReadiness()"> Actualizaci√≥n de pol√≠ticas de seguridad</label>
                </div>
                
                <div class="progress-bar" style="margin-top: 20px;">
                    <div class="progress-fill" id="readiness-progress">0%</div>
                </div>
                
                <div id="readiness-status" class="info-box" style="margin-top: 20px;"></div>
            </div>
        </section>

        <!-- Secci√≥n 7: Recursos y Herramientas -->
        <section class="section">
            <h2>üõ†Ô∏è Recursos y Herramientas</h2>
            
            <h3>Bibliotecas Open Source</h3>
            <div class="code-block">
# Ejemplo: liboqs (Open Quantum Safe)
from oqs import Signature

# Crear firmante con Dilithium
with Signature("Dilithium2") as signer:
    public_key = signer.generate_keypair()
    message = b"Mensaje importante"
    signature = signer.sign(message)
    
    # Verificar firma
    is_valid = signer.verify(message, signature, public_key)
            </div>

            <h3>Recursos de Aprendizaje</h3>
            <ul>
                <li><strong>NIST Post-Quantum Cryptography:</strong> csrc.nist.gov/projects/post-quantum-cryptography</li>
                <li><strong>Open Quantum Safe:</strong> openquantumsafe.org</li>
                <li><strong>PQShield:</strong> pqshield.com/learning-center/</li>
                <li><strong>ETSI Quantum Safe Cryptography:</strong> etsi.org</li>
            </ul>
        </section>

        <!-- Secci√≥n 8: Temas para profundizar -->
        <section class="section">
            <h2>üìö Temas para profundizar</h2>
            <p>Conceptos que no cubrimos a detalle, pero valen la pena estudiar:</p>
            <ul>
                <li><strong>Rounding/Decoding:</strong> c√≥mo se mapea m' a bits (0/1) con tolerancia a ruido.</li>
                <li><strong>Learning With Errors (LWE):</strong> base matem√°tica que garantiza seguridad.</li>
                <li><strong>Par√°metros y niveles:</strong> c√≥mo se eligen tama√±os de clave para diferentes niveles de seguridad.</li>
                <li><strong>CCA vs CPA:</strong> por qu√© Kyber usa t√©cnicas para resistir ataques de texto cifrado adaptativo.</li>
                <li><strong>Calidad de aleatoriedad:</strong> impacto de RNG d√©bil en la seguridad.</li>
                <li><strong>Side-channels:</strong> ataques por tiempo/consumo y c√≥mo mitigarlos (constant-time).</li>
                <li><strong>Tolerancia a fallos:</strong> c√≥mo manejar errores f√≠sicos y computaci√≥n imperfecta.</li>
                <li><strong>Implementaci√≥n real:</strong> empaquetado de claves, formatos, y compatibilidad con TLS.</li>
            </ul>
        </section>

        <!-- Conclusi√≥n -->
        <section class="conclusion">
            <h2>üéØ Conclusiones Clave</h2>
            
            <div style="text-align: left; margin-top: 30px;">
                <h3 style="color: white;">La Amenaza es Real</h3>
                <p>Las computadoras cu√°nticas har√°n obsoleta la mayor√≠a de la criptograf√≠a actual. Aunque las computadoras cu√°nticas suficientemente poderosas a√∫n no existen, el ataque "Harvest Now, Decrypt Later" significa que debemos actuar YA.</p>
                
                <h3 style="color: white;">Tenemos Soluciones</h3>
                <p>La criptograf√≠a post-cu√°ntica ya est√° estandarizada y lista para implementaci√≥n. CRYSTALS-Kyber, Dilithium y SPHINCS+ ofrecen seguridad probada contra amenazas cu√°nticas.</p>
                
                <h3 style="color: white;">La Transici√≥n es Urgente</h3>
                <p>Migrar la infraestructura criptogr√°fica mundial tomar√° a√±os, posiblemente d√©cadas. Las organizaciones deben comenzar la planificaci√≥n e implementaci√≥n inmediatamente.</p>
                
                <h3 style="color: white;">El Camino Adelante</h3>
                <ul>
                    <li>Inventariar sistemas criptogr√°ficos actuales</li>
                    <li>Implementar soluciones h√≠bridas (cl√°sica + post-cu√°ntica)</li>
                    <li>Capacitar equipos en nuevas tecnolog√≠as</li>
                    <li>Seguir de cerca los est√°ndares NIST</li>
                    <li>Planificar migraci√≥n completa para 2030-2035</li>
                </ul>
                
                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; margin-top: 30px;">
                    <h3 style="color: white; text-align: center;">üí° Mensaje Final</h3>
                    <p style="text-align: center; font-size: 1.2em;">
                        La seguridad cu√°ntica no es el futuro - es el presente. Las organizaciones que act√∫en ahora estar√°n preparadas para la era post-cu√°ntica. Las que esperen enfrentar√°n riesgos existenciales.
                    </p>
                </div>
            </div>
        </section>

        <footer style="text-align: center; padding: 40px; color: white;">
            <p>Presentaci√≥n Interactiva sobre Criptograf√≠a Post-Cu√°ntica</p>
            <p style="opacity: 0.8; margin-top: 10px;">Creado para educaci√≥n y concientizaci√≥n sobre seguridad cu√°ntica</p>
        </footer>
    </div>

    <script>
        let drawMode = "free"; // "free" | "line"
let lineStart = null;
let snapshot = null;
let historyStack = [];
const maxHistory = 50;
        // ===== DEMOSTRACI√ìN DE SUPERPOSICI√ìN =====
        function classicalCompute() {
            const result = document.getElementById('classical-result');
            const state = Math.random() > 0.5 ? '1' : '0';
            result.innerHTML = `
                <strong>Estado procesado:</strong> ${state}<br>
                <strong>Posibilidades exploradas:</strong> 1<br>
                <em>Un bit cl√°sico solo puede estar en UN estado a la vez.</em>
            `;
        }

        function quantumCompute() {
            const result = document.getElementById('quantum-result');
            result.innerHTML = `
                <strong>Estados en superposici√≥n:</strong> |0‚ü© y |1‚ü© simult√°neamente<br>
                <strong>Posibilidades exploradas:</strong> 2<br>
                <strong>Al medir:</strong> ${Math.random() > 0.5 ? '|1‚ü©' : '|0‚ü©'}<br>
                <em>Un qubit procesa AMBOS estados al mismo tiempo hasta que se mide.</em>
            `;
        }

        // ===== DEMOSTRACI√ìN RSA =====
        let rsaKeys = {};
        
        function gcd(a, b) {
            while (b !== 0) {
                let t = b;
                b = a % b;
                a = t;
            }
            return a;
        }

        function modPow(base, exp, mod) {
            let result = 1;
            base = base % mod;
            while (exp > 0) {
                if (exp % 2 === 1) {
                    result = (result * base) % mod;
                }
                exp = Math.floor(exp / 2);
                base = (base * base) % mod;
            }
            return result;
        }

        function modInverse(e, phi) {
            let [old_r, r] = [phi, e];
            let [old_s, s] = [0, 1];
            
            while (r !== 0) {
                let quotient = Math.floor(old_r / r);
                [old_r, r] = [r, old_r - quotient * r];
                [old_s, s] = [s, old_s - quotient * s];
            }
            
            return old_s < 0 ? old_s + phi : old_s;
        }

        function generateRSAKeys() {
            // Usar primos peque√±os para demostraci√≥n
            const primes = [61, 67, 71, 73, 79, 83, 89, 97, 101, 103];
            const p = primes[Math.floor(Math.random() * primes.length)];
            let q = primes[Math.floor(Math.random() * primes.length)];
            while (q === p) {
                q = primes[Math.floor(Math.random() * primes.length)];
            }
            
            const n = p * q;
            const phi = (p - 1) * (q - 1);
            
            // Encontrar e
            let e = 3;
            while (e < phi) {
                if (gcd(e, phi) === 1) break;
                e += 2;
            }
            
            // Calcular d
            const d = modInverse(e, phi);
            
            rsaKeys = { p, q, n, e, d, phi };
            
            document.getElementById('p-value').textContent = p;
            document.getElementById('q-value').textContent = q;
            document.getElementById('n-value').textContent = n;
            document.getElementById('e-value').textContent = e;
            document.getElementById('n-public').textContent = n;
            document.getElementById('d-value').textContent = d;
            document.getElementById('n-private').textContent = n;
            
            document.getElementById('rsa-keys').style.display = 'block';
            document.getElementById('encrypt-btn').style.display = 'inline-block';
        }

        function encryptRSA() {
            const message = document.getElementById('rsa-message').value;
            if (!message) {
                alert('Por favor ingresa un mensaje');
                return;
            }
            
            const encrypted = [];
            for (let i = 0; i < message.length; i++) {
                const m = message.charCodeAt(i);
                const c = modPow(m, rsaKeys.e, rsaKeys.n);
                encrypted.push(c);
            }
            
            rsaKeys.encrypted = encrypted;
            rsaKeys.originalMessage = message;
            
            document.getElementById('encrypted-text').textContent = encrypted.join(', ');
            document.getElementById('rsa-encrypted').style.display = 'block';
            document.getElementById('decrypt-btn').style.display = 'inline-block';
        }

        function decryptRSA() {
            const decrypted = [];
            for (let c of rsaKeys.encrypted) {
                const m = modPow(c, rsaKeys.d, rsaKeys.n);
                decrypted.push(String.fromCharCode(m));
            }
            
            document.getElementById('decrypted-text').textContent = decrypted.join('');
            document.getElementById('rsa-decrypted').style.display = 'block';
        }

        function simulateQuantumBreak() {
            if (!rsaKeys.n) {
                alert('Primero genera las claves RSA');
                return;
            }
            
            document.getElementById('quantum-attack').style.display = 'block';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                document.getElementById('attack-progress').style.width = progress + '%';
                document.getElementById('attack-progress').textContent = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    document.getElementById('attack-result').innerHTML = `
                        <strong>üîì ¬°Ataque Exitoso!</strong><br>
                        Factorizaci√≥n cu√°ntica completada:<br>
                        n = ${rsaKeys.n} = ${rsaKeys.p} √ó ${rsaKeys.q}<br>
                        Clave privada recuperada: d = ${rsaKeys.d}<br>
                        <br>
                        <strong>Mensaje desencriptado sin clave privada original:</strong><br>
                        "${rsaKeys.originalMessage}"<br>
                        <br>
                        <em>Con el algoritmo de Shor, esto tomar√≠a solo horas en una computadora cu√°ntica real.</em>
                    `;
                }
            }, 200);
        }

        // ===== DEMO SHOR (SIMPLIFICADA) =====
        let shorState = null;
        let shorTimer = null;

        function updateShorAOptions() {
            const nSelect = document.getElementById('shor-n');
            const aSelect = document.getElementById('shor-a');
            if (!nSelect || !aSelect) return;

            const n = parseInt(nSelect.value, 10);
            const coprimes = [];
            for (let i = 2; i < n; i += 1) {
                if (gcd(i, n) === 1) coprimes.push(i);
            }

            aSelect.innerHTML = coprimes.map(val => `<option value="${val}">${val}</option>`).join('');
        }

        function findPeriod(n, a) {
            const sequence = [];
            let value = 1;
            let r = null;
            for (let x = 1; x <= n; x += 1) {
                value = (value * a) % n;
                sequence.push({ x, value });
                if (value === 1) {
                    r = x;
                    break;
                }
            }
            return { r, sequence };
        }

        function isUsefulA(n, a) {
            const { r } = findPeriod(n, a);
            if (!r || r % 2 !== 0) return false;
            const apow = modPow(a, r / 2, n);
            return apow !== n - 1;
        }

        function buildShorSteps(n, a) {
            const { r, sequence } = findPeriod(n, a);
            const seqText = sequence.map(step => `${a}^${step.x} mod ${n} = ${step.value}`).join(' ¬∑ ');
            const rEven = r && r % 2 === 0;
            const apow = rEven ? modPow(a, r / 2, n) : null;
            const conditionOk = rEven && apow !== n - 1;
            const factor1 = conditionOk ? gcd(apow - 1, n) : null;
            const factor2 = conditionOk ? gcd(apow + 1, n) : null;

            const steps = [
                {
                    title: "Paso 1 ‚Äî Elegir a coprimo",
                    detail: `a = ${a}, gcd(a, N) = ${gcd(a, n)}`
                },
                {
                    title: "Paso 2 ‚Äî Encontrar el per√≠odo r",
                    detail: `Secuencia: ${seqText}<br>Per√≠odo r = ${r ?? "no encontrado"}`
                },
                {
                    title: "Paso 3 ‚Äî Verificar condici√≥n",
                    detail: r
                        ? `r ${rEven ? "es par" : "es impar"}; a^(r/2) mod N = ${rEven ? apow : "‚Äî"}`
                        : "No se encontr√≥ un per√≠odo v√°lido."
                },
                {
                    title: "Paso 4 ‚Äî Obtener factores",
                    detail: conditionOk
                        ? `gcd(a^(r/2)-1, N) = ${factor1}<br>gcd(a^(r/2)+1, N) = ${factor2}`
                        : "Este a no produce factores √∫tiles. Prueba otro a."
                }
            ];

            return { steps, conditionOk };
        }

        function initShorDemo() {
            const nSelect = document.getElementById('shor-n');
            const aSelect = document.getElementById('shor-a');
            const status = document.getElementById('shor-status');
            const nextBtn = document.getElementById('shor-next');
            const autoBtn = document.getElementById('shor-auto');
            const tryBtn = document.getElementById('shor-try');
            const progress = document.getElementById('shor-progress');
            const stepsList = document.getElementById('shor-steps');

            if (!nSelect || !aSelect || !status || !nextBtn || !autoBtn || !tryBtn || !progress || !stepsList) return;

            if (shorTimer) clearInterval(shorTimer);

            const n = parseInt(nSelect.value, 10);
            const a = parseInt(aSelect.value, 10);
            const { steps, conditionOk } = buildShorSteps(n, a);

            shorState = {
                n,
                a,
                steps,
                stepIndex: -1
            };

            stepsList.innerHTML = steps.map((step, i) => `
                <div class="shor-step" data-step="${i}">
                    <div class="shor-step-title">${step.title}</div>
                    <div class="shor-step-detail">${step.detail}</div>
                </div>
            `).join('');

            status.innerHTML = `Listo para iniciar con N = ${n} y a = ${a}.`;
            progress.style.width = '0%';
            progress.textContent = '0%';
            nextBtn.disabled = false;
            autoBtn.disabled = false;
            tryBtn.disabled = conditionOk;
        }

        function nextShorStep() {
            if (!shorState) return;

            const { steps } = shorState;
            const status = document.getElementById('shor-status');
            const progress = document.getElementById('shor-progress');

            if (shorState.stepIndex >= steps.length - 1) {
                if (shorTimer) clearInterval(shorTimer);
                return;
            }

            if (shorState.stepIndex >= 0) {
                const prev = document.querySelector(`#shor-steps [data-step="${shorState.stepIndex}"]`);
                if (prev) prev.classList.remove('active');
                if (prev) prev.classList.add('done');
            }

            shorState.stepIndex += 1;
            const current = document.querySelector(`#shor-steps [data-step="${shorState.stepIndex}"]`);
            if (current) current.classList.add('active');

            const pct = Math.round(((shorState.stepIndex + 1) / steps.length) * 100);
            progress.style.width = `${pct}%`;
            progress.textContent = `${pct}%`;
            if (status) {
                status.innerHTML = `<strong>${steps[shorState.stepIndex].title}</strong><br>${steps[shorState.stepIndex].detail}`;
            }

            if (shorState.stepIndex >= steps.length - 1 && shorTimer) {
                clearInterval(shorTimer);
            }
        }

        function autoShorSteps() {
            if (!shorState) return;
            if (shorTimer) clearInterval(shorTimer);

            shorTimer = setInterval(() => {
                if (!shorState || shorState.stepIndex >= shorState.steps.length - 1) {
                    clearInterval(shorTimer);
                    return;
                }
                nextShorStep();
            }, 1200);
        }

        function tryAnotherA() {
            const nSelect = document.getElementById('shor-n');
            const aSelect = document.getElementById('shor-a');
            if (!nSelect || !aSelect) return;

            const n = parseInt(nSelect.value, 10);
            const options = Array.from(aSelect.options).map(opt => parseInt(opt.value, 10));
            if (options.length === 0) return;

            const current = parseInt(aSelect.value, 10);
            const startIndex = options.indexOf(current);
            let chosen = null;

            for (let i = 1; i <= options.length; i += 1) {
                const candidate = options[(startIndex + i) % options.length];
                if (isUsefulA(n, candidate)) {
                    chosen = candidate;
                    break;
                }
            }

            aSelect.value = chosen ?? options[(startIndex + 1) % options.length];
            initShorDemo();
        }

        // ===== KYBER INTERACTIVO (NUMEROS PEQUENOS) =====
        const kyberState = {
            step: 0,
            data: null
        };

        function kyberMod(n, m) {
            return ((n % m) + m) % m;
        }

        function kyberMulMatVec(matrix, vector) {
            return matrix.map(row => row.reduce((sum, val, i) => sum + val * vector[i], 0));
        }

        function kyberCompute() {
            const modulo = 17;
            const A = [[12, 5], [3, 8]];
            const s = [2, 3];
            const e = [1, -1];
            const r = [1, 2];
            const e1 = [1, 0];
            const e2 = 1;

            const bitSelect = document.getElementById("kyber-bit");
            const message = bitSelect ? parseInt(bitSelect.value, 10) : 1;
            const messageScaled = message * 8;

            const As = kyberMulMatVec(A, s).map(x => kyberMod(x, modulo));
            const b = As.map((val, i) => kyberMod(val + e[i], modulo));

            const At = [[A[0][0], A[1][0]], [A[0][1], A[1][1]]];
            const Atr = kyberMulMatVec(At, r).map(x => kyberMod(x, modulo));
            const u = Atr.map((val, i) => kyberMod(val + e1[i], modulo));

            const btr = b.reduce((sum, val, i) => sum + val * r[i], 0);
            const v = kyberMod(btr + e2 + messageScaled, modulo);

            const stu = s.reduce((sum, val, i) => sum + val * u[i], 0);
            const decrypted = kyberMod(v - stu, modulo);
            const recoveredMessage = decrypted >= 4 && decrypted <= 12 ? 1 : 0;

            return {
                modulo, A, s, e, r, e1, e2,
                message, messageScaled,
                As, b, At, Atr, u, btr, v, stu,
                decrypted, recoveredMessage
            };
        }

        function kyberSteps(data) {
            return [
                {
                    title: "Configuracion inicial",
                    desc: "Trabajamos modulo 17 y vectores de dimension 2.",
                    formula: "Todo modulo q = 17",
                    details: [
                        `q = ${data.modulo}`,
                        `A = [[${data.A[0].join(", ")}],[${data.A[1].join(", ")}]]`,
                        "Dimension 2 (solo para aprender)"
                    ]
                },
                {
                    title: "Bob elige su secreto",
                    desc: "Bob crea su clave privada s y un ruido e.",
                    formula: "s secreto, e ruido pequeno",
                    details: [
                        `s = [${data.s.join(", ")}]`,
                        `e = [${data.e.join(", ")}]`
                    ]
                },
                {
                    title: "Clave publica de Bob",
                    desc: "b = A * s + e (mod q)",
                    formula: "b = A*s + e (mod q)",
                    details: [
                        `A*s = [${data.As.join(", ")}]`,
                        `b = [${data.b.join(", ")}]`
                    ]
                },
                {
                    title: "Alice prepara mensaje",
                    desc: "Alice fija m y elige valores aleatorios.",
                    formula: "m' = m * 8",
                    details: [
                        `m = ${data.message}  ->  m' = ${data.messageScaled}`,
                        `r = [${data.r.join(", ")}]`,
                        `e1 = [${data.e1.join(", ")}], e2 = ${data.e2}`
                    ]
                },
                {
                    title: "Componente u",
                    desc: "u = A^T * r + e1 (mod q)",
                    formula: "u = A^T*r + e1 (mod q)",
                    details: [
                        `A^T*r = [${data.Atr.join(", ")}]`,
                        `u = [${data.u.join(", ")}]`
                    ]
                },
                {
                    title: "Componente v",
                    desc: "v = b^T * r + e2 + m' (mod q)",
                    formula: "v = b^T*r + e2 + m' (mod q)",
                    details: [
                        `b^T*r = ${kyberMod(data.btr, data.modulo)}`,
                        `v = ${data.v}`
                    ]
                },
                {
                    title: "Cifrado enviado",
                    desc: "Alice envia (u, v).",
                    formula: "cipher = (u, v)",
                    details: [
                        `u = [${data.u.join(", ")}]`,
                        `v = ${data.v}`
                    ]
                },
                {
                    title: "Bob descifra",
                    desc: "m' ‚âà v - s^T*u (mod q)",
                    formula: "m' = v - s^T*u (mod q)",
                    details: [
                        `s^T*u = ${kyberMod(data.stu, data.modulo)}`,
                        `m' = ${data.decrypted}`
                    ]
                },
                {
                    title: "Decodificacion",
                    desc: "Si m' esta cerca de 0 -> 0, cerca de 8 -> 1.",
                    formula: "m = Decode(m')",
                    details: [
                        `m' = ${data.decrypted}`,
                        `Mensaje recuperado = ${data.recoveredMessage}`
                    ]
                }
            ];
        }

        function kyberRender() {
            kyberState.data = kyberCompute();
            const steps = kyberSteps(kyberState.data);
            const step = Math.max(0, Math.min(kyberState.step, steps.length - 1));
            kyberState.step = step;

            const title = document.getElementById("kyber-step-title");
            const desc = document.getElementById("kyber-step-desc");
            const formula = document.getElementById("kyber-step-formula");
            const details = document.getElementById("kyber-step-details");
            const keybox = document.getElementById("kyber-step-keybox");
            const list = document.getElementById("kyber-step-list");
            const progress = document.getElementById("kyber-progress");
            if (!title || !desc || !formula || !details || !keybox || !list || !progress) return;

            title.textContent = `Paso ${step + 1}: ${steps[step].title}`;
            desc.textContent = steps[step].desc;
            formula.textContent = steps[step].formula;
            details.innerHTML = steps[step].details.map(line => `<div class="kyber-math-line">${line}</div>`).join("");
            keybox.innerHTML = kyberKeyChips(step, kyberState.data);
            list.innerHTML = kyberStepList(step, kyberState.data);

            const totalSteps = steps.length - 1;
            const pct = totalSteps <= 0 ? 100 : Math.round((step / totalSteps) * 100);
            progress.style.width = `${pct}%`;
            progress.textContent = `${pct}%`;

        }

        function kyberNext() {
            kyberState.step += 1;
            kyberRender();
        }

        function kyberPrev() {
            kyberState.step -= 1;
            kyberRender();
        }

        function kyberReset() {
            kyberState.step = 0;
            kyberRender();
        }

        function kyberKeyChips(step, data) {
            const chips = [];
            if (step === 0) {
                chips.push(`q=${data.modulo}`);
                chips.push(`A=[[${data.A[0].join(", ")}],[${data.A[1].join(", ")}]]`);
            } else if (step === 1) {
                chips.push(`s=[${data.s.join(", ")}]`);
                chips.push(`e=[${data.e.join(", ")}]`);
            } else if (step === 2) {
                chips.push(`b=[${data.b.join(", ")}]`);
            } else if (step === 3) {
                chips.push(`m=${data.message}`);
                chips.push(`m'=${data.messageScaled}`);
                chips.push(`r=[${data.r.join(", ")}]`);
            } else if (step === 4) {
                chips.push(`u=[${data.u.join(", ")}]`);
            } else if (step === 5) {
                chips.push(`v=${data.v}`);
            } else if (step === 6) {
                chips.push(`(u, v)=([${data.u.join(", ")}], ${data.v})`);
            } else if (step === 7) {
                chips.push(`m'=${data.decrypted}`);
            } else if (step === 8) {
                chips.push(`m=${data.recoveredMessage}`);
            }
            return chips.map(item => {
                const parts = item.split("=");
                if (parts.length === 2) {
                    return `<span class="kyber-pill"><strong>${parts[0]}</strong>${parts[1]}</span>`;
                }
                return `<span class="kyber-pill">${item}</span>`;
            }).join("");
        }

        function kyberStepList(step, data) {
            const lines = [];
            if (step === 0) {
                lines.push("Objetivo: acordar un secreto usando reticulas (LWE).");
                lines.push("Todo es modulo q=17 para que los numeros sean pequenos.");
            } else if (step === 1) {
                lines.push("Bob elige s (secreto) y un ruido pequeno e.");
                lines.push("Solo Bob conoce s.");
            } else if (step === 2) {
                lines.push("Bob publica b = A*s + e.");
                lines.push("A y b son publicos.");
            } else if (step === 3) {
                lines.push("Alice fija el bit m y lo escala a m'.");
                lines.push("Alice elige r, e1, e2 aleatorios.");
            } else if (step === 4) {
                lines.push("Alice calcula u = A^T*r + e1.");
            } else if (step === 5) {
                lines.push("Alice calcula v = b^T*r + e2 + m'.");
            } else if (step === 6) {
                lines.push("Alice envia el cifrado (u, v).");
            } else if (step === 7) {
                lines.push("Bob calcula m' = v - s^T*u.");
            } else if (step === 8) {
                lines.push("Bob decodifica m' y recupera m.");
            }
            if (!lines.length) return "";
            return `<ol>${lines.map(line => `<li>${line}</li>`).join("")}</ol>`;
        }

        

        // ===== SIMULADOR DE ATAQUES =====
        function attackClassical(system) {
            const resultId = system + '-attack-result';
            const result = document.getElementById(resultId);
            
            if (system === 'rsa') {
                result.innerHTML = `
                    <strong>‚è≥ Atacando RSA-2048 con computadora cl√°sica...</strong><br><br>
                    M√©todo: Factorizaci√≥n con algoritmos cl√°sicos (GNFS)<br>
                    Tiempo estimado: <span style="color: #28a745; font-weight: bold;">~300 a√±os</span> con supercomputadora<br>
                    Estado: <span style="color: #28a745;">‚úÖ SEGURO contra ataques cl√°sicos</span>
                `;
            } else {
                result.innerHTML = `
                    <strong>‚è≥ Atacando Kyber-768 con computadora cl√°sica...</strong><br><br>
                    M√©todo: Fuerza bruta sobre ret√≠culas<br>
                    Tiempo estimado: <span style="color: #28a745; font-weight: bold;">~2^140 a√±os</span> (m√°s que la edad del universo)<br>
                    Estado: <span style="color: #28a745;">‚úÖ SEGURO contra ataques cl√°sicos</span>
                `;
            }
        }
        function attackQuantum(system) {
            const resultId = system + '-attack-result';
            const result = document.getElementById(resultId);
            
            if (system === 'rsa') {
                result.innerHTML = `
                    <strong>‚öõÔ∏è Atacando RSA-2048 con computadora cu√°ntica...</strong><br><br>
                    M√©todo: Algoritmo de Shor<br>
                    Qubits necesarios: ~4000 qubits l√≥gicos<br>
                    Tiempo estimado: <span style="color: #dc3545; font-weight: bold;">~8 horas</span><br>
                    Estado: <span style="color: #dc3545;">‚ùå VULNERABLE - Completamente roto</span><br><br>
                    <em>La clave privada puede ser calculada factorizando n = p √ó q</em>
                `;
            } else {
                result.innerHTML = `
                    <strong>‚öõÔ∏è Atacando Kyber-768 con computadora cu√°ntica...</strong><br><br>
                    M√©todo: Algoritmo de Grover (mejor ataque conocido)<br>
                    Qubits necesarios: Millones de qubits<br>
                    Tiempo estimado: <span style="color: #28a745; font-weight: bold;">~2^70 a√±os</span><br>
                    Estado: <span style="color: #28a745;">‚úÖ SEGURO - Resistente a ataques cu√°nticos</span><br><br>
                    <em>Los problemas de ret√≠culas permanecen dif√≠ciles incluso para computadoras cu√°nticas</em>
                `;
            }
        }

        // ===== CHECKLIST DE PREPARACI√ìN =====
        function updateReadiness() {
            const checkboxes = document.querySelectorAll('#readiness-checklist input[type="checkbox"]');
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const total = checkboxes.length;
            const percentage = Math.round((checked / total) * 100);
            
            document.getElementById('readiness-progress').style.width = percentage + '%';
            document.getElementById('readiness-progress').textContent = percentage + '%';
            
            const statusDiv = document.getElementById('readiness-status');
            
            if (percentage === 0) {
                statusDiv.innerHTML = '<strong>üî¥ No iniciado:</strong> Tu organizaci√≥n a√∫n no ha comenzado la transici√≥n a criptograf√≠a post-cu√°ntica.';
                statusDiv.style.borderColor = '#dc3545';
                statusDiv.style.background = '#f8d7da';
            } else if (percentage < 50) {
                statusDiv.innerHTML = '<strong>üü° Fase inicial:</strong> Has dado los primeros pasos. Contin√∫a con el inventario y planificaci√≥n.';
                statusDiv.style.borderColor = '#ffc107';
                statusDiv.style.background = '#fff3cd';
            } else if (percentage < 80) {
                statusDiv.innerHTML = '<strong>üü† Progreso medio:</strong> Buen avance. Enf√≥cate en implementaci√≥n y capacitaci√≥n.';
                statusDiv.style.borderColor = '#fd7e14';
                statusDiv.style.background = '#ffe5d0';
            } else if (percentage < 100) {
                statusDiv.innerHTML = '<strong>üü¢ Casi listo:</strong> Excelente progreso. Completa los √∫ltimos pasos para estar preparado.';
                statusDiv.style.borderColor = '#28a745';
                statusDiv.style.background = '#d4edda';
            } else {
                statusDiv.innerHTML = '<strong>‚úÖ Completamente preparado:</strong> Tu organizaci√≥n est√° lista para la era post-cu√°ntica. ¬°Excelente trabajo!';
                statusDiv.style.borderColor = '#28a745';
                statusDiv.style.background = '#d4edda';
            }
        }

        // Inicializar el checklist
        updateReadiness();
        updateShorAOptions();
        let boardCanvas, boardCtx;
let drawing = false;
let brushColor = "#ffffff";
let brushSize = 6;
let isEraser = false;

function openBoard() {
  const overlay = document.getElementById("whiteboard");
  overlay.style.display = "flex";

  boardCanvas = document.getElementById("boardCanvas");
  boardCtx = boardCanvas.getContext("2d");

  // Ajustar tama√±o real
  const dpr = window.devicePixelRatio || 1;
  boardCanvas.width = boardCanvas.clientWidth * dpr;
  boardCanvas.height = boardCanvas.clientHeight * dpr;
  boardCtx.scale(dpr, dpr);

  boardCtx.lineCap = "round";
  applyBrush();

  boardCanvas.addEventListener("mousedown", startDraw);
  boardCanvas.addEventListener("mousemove", draw);
  boardCanvas.addEventListener("mouseup", stopDraw);
  boardCanvas.addEventListener("mouseleave", stopDraw);

  boardCanvas.addEventListener("touchstart", startDraw, { passive: false });
  boardCanvas.addEventListener("touchmove", draw, { passive: false });
  boardCanvas.addEventListener("touchend", stopDraw);
}

function closeBoard() {
  const overlay = document.getElementById("whiteboard");
  overlay.style.display = "none";
}

function applyBrush() {
  if (!boardCtx) return;
  boardCtx.lineWidth = brushSize;
  if (isEraser) {
    boardCtx.globalCompositeOperation = "destination-out";
    boardCtx.strokeStyle = "rgba(0,0,0,1)";
  } else {
    boardCtx.globalCompositeOperation = "source-over";
    boardCtx.strokeStyle = brushColor;
  }
}

function startDraw(e) {
  e.preventDefault();
  const pos = getPos(e, boardCanvas);
  drawing = true;
  boardCtx.beginPath();
  boardCtx.moveTo(pos.x, pos.y);
}

function draw(e) {
  if (!drawing) return;
  e.preventDefault();
  const pos = getPos(e, boardCanvas);
  boardCtx.lineTo(pos.x, pos.y);
  boardCtx.stroke();
}

function stopDraw(e) {
  if (!drawing) return;
  e.preventDefault();
  drawing = false;
  boardCtx.closePath();
}

function setBrushColor(value) {
  brushColor = value;
  if (!isEraser) applyBrush();
}

function setBrushSize(value) {
  brushSize = Number(value);
  applyBrush();
}

function toggleEraser() {
  isEraser = !isEraser;
  const eraserBtn = document.getElementById("eraserToggle");
  if (eraserBtn) eraserBtn.classList.toggle("active", isEraser);
  applyBrush();
}

function clearCanvas() {
  if (!boardCtx || !boardCanvas) return;
  const dpr = window.devicePixelRatio || 1;
  boardCtx.clearRect(0, 0, boardCanvas.width / dpr, boardCanvas.height / dpr);
}
function drawReticulaDemo() {
  if (!boardCtx || !boardCanvas) return;
  clearCanvas();

  const w = boardCanvas.clientWidth;
  const h = boardCanvas.clientHeight;
  const step = 36;

  // Fondo
  boardCtx.fillStyle = "#0b1020";
  boardCtx.fillRect(0, 0, w, h);

  // Reticula simple (solo puntos)
  boardCtx.fillStyle = "rgba(160,220,255,0.7)";
  for (let x = step; x <= w - step; x += step) {
    for (let y = step; y <= h - step; y += step) {
      boardCtx.beginPath();
      boardCtx.arc(x, y, 2.2, 0, Math.PI * 2);
      boardCtx.fill();
    }
  }
}
        kyberRender();
function getPos(e, canvas) {
  const rect = canvas.getBoundingClientRect();

  if (e.touches && e.touches[0]) {
    return {
      x: e.touches[0].clientX - rect.left,
      y: e.touches[0].clientY - rect.top
    };
  }

  return {
    x: e.offsetX,
    y: e.offsetY
  };
}

    </script>
    <!-- PIZARRA -->
<div class="whiteboard-overlay" id="whiteboard">
  <div class="whiteboard-header">
    <label>üé® <input type="color" value="#ffffff" oninput="setBrushColor(this.value)"></label>
    <label>üñåÔ∏è <input type="range" min="2" max="24" value="6" oninput="setBrushSize(this.value)"></label>
    <button type="button" class="tool-toggle" id="eraserToggle" onclick="toggleEraser()">üßΩ Borrador</button>
    <button type="button" class="tool-secondary" onclick="drawReticulaDemo()">üìê Reticula</button>
    <button class="clear" onclick="clearCanvas()">üóëÔ∏è Limpiar</button>
    <button class="close" onclick="closeBoard()">‚ùå Cerrar</button>
  </div>
  <canvas class="whiteboard-canvas" id="boardCanvas"></canvas>
</div>
</body>
</html>
